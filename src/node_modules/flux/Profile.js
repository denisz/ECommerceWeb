import { Store } from 'modules/Flux';
import Actions from './ProfileActions';
import XHR, { Methods } from './XHR';

export class Profile extends Store {
  constructor() {
    super();

    this.id = 'profile';
    this.listenables = Actions;
  }

  /**
   * Загрузка профиля из сервера
   * @param id
   * @returns {Promise.<void>}
   */
  async onFetch(id) {
    const { responseData } = await XHR(Methods.GET, { path: `profile/${id}` });
    this.setState(responseData);
  }

  /**
   * Обновить профиля
   * @param body
   * @returns {Promise.<void>}
   */
  async onSave(body) {
    const { id } = this.state;
    const { responseData } = await XHR(Methods.PUT, { path: `profile/${id}`, body });
    this.setState(responseData);
  }
}

export default new Profile();
