import React from 'react';
import cx from 'classnames';
import Sale from 'components/Sale';
import Link from 'components/Link';
import Date from 'components/Date';
import {Price} from 'components/Currency';
import Shipping from 'components/Shipping';
import Dictionary from 'components/Dictionary';
import Address, {parse} from 'components/Address';
import './Order.css';

export default ({className, createdAt, positions, address, discount, delivery, deliveryPrice, productPrice, subtotal, total, user = false}) => (
    <div className={cx('Order', className)}>
      {
        createdAt &&
        <div>Дата создания: <strong><Date value={createdAt}/></strong></div>
      }

      <table className="table table-bordered Order__table">

        <thead>
        <tr>
          <th scope="col">Товар</th>
          <th scope="col">Цена</th>
        </tr>
        </thead>

        <tbody>
        {
          positions.map((i, idx) => (
              <tr key={idx}>
                <td>
                  <Link
                      to={`/product/${i.product.SKU}`}
                      external
                      className="Order__name"
                  >
                    {i.product.name} <br/>
                    <small className="text-muted">{i.product.producer}</small>
                  </Link>
                  <span>{` x ${i.amount}`}</span>
                </td>
                <td>
                  <Price value={i.total} className="Order__price"/>
                </td>
              </tr>
          ))
        }
        </tbody>
      </table>

      <Dictionary
          className="Order__dict"
          pairs={[
            {
              label: 'Цена товара:',
              value: <Price value={productPrice} className="Order__price"/>,
            },
            {
              label: 'Скидка:',
              value: <Sale {...discount} className="Order__sale"/>,
            },
            {
              label: 'Цена со скидкой:',
              value: <Price value={subtotal} className="Order__price"/>,
            },
          ]}
      />
      {
        user &&
        <h6 className="text-muted">
          <small>
            На товары участвующие в распродаже система скидок не
            распространяется, и при совместном заказе с другими товарами их
            стоимость не учитывается в общей сумме заказа для расчета скидки.
          </small>
        </h6>
      }

      <Dictionary
          className="Order__dict"
          pairs={[
            {
              label: 'Доставка:',
              value: <Shipping {...delivery}/>,
            },
            {
              label: 'Цена доставки:',
              value: <Price value={deliveryPrice} className="Order__price"/>,
            },
            {
              label: 'Итого к оплате:',
              value: <Price value={total} className="Order__price"/>,
            },
          ]}
      />

      <div className="Order__address">
        <Address {...parse(address)}/>
      </div>
    </div>
)