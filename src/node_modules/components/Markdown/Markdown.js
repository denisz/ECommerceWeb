import React, {Component} from 'react';
import PropTypes from 'prop-types';
import AsyncComponent from 'components/AsyncComponent';
import MarkdownRender from 'react-markdown';

export default class Markdown extends Component {
  load = async () => {
    const {file} = this.props;
    const result = await fetch(file);
    const source = await result.text();
    return () => <MarkdownRender source={source}/>;
  };

  render() {
    const {error, loading} = this.props;

    return (
        <div className="Markdown">
          <AsyncComponent resolve={this.load}
                          error={error}
                          loading={loading}/>
        </div>
    );
  }
}

Markdown.propTypes = {
  error: PropTypes.func,
  loading: PropTypes.func,
  file: PropTypes.string.isRequired,
};
Markdown.defaultProps = {
  error: (err) => <span>{err.message}</span>,
  loading: () => <span>Загрузка</span>,
};